---
title: gitlab 实战笔记
date: 2016-08-05 16:49:23
tags:
  - git
  - gitlab
  - 笔记
---

## GitLab 是一个用于仓库管理系统的开源项目。
集代码托管，测试，部署于一体。
New integration! Koding + GitLab: one-click to build every project, issue, and merge request in a complete IDE!
![image](images/gitlab.png)

## GitLab CI Runner
Gitlab 代码持续集成插件

```
openssl genrsa -des3 -out ca.key 1024
openssl rsa -in ca.key -out ca.key
openssl req -new -x509 -key ca.key -out ca.crt -days 999
```
    https://10.88.1.241:20443/
    http://10.88.1.241:20080
建立SSL目录,然后拷贝你的证书到SSL目录:

```
# mkdir /etc/gitlab/ssl
# chmod 700 /etc/gitlab/ssl
# cp ca.crt ca.key /etc/gitlab/ssl/
编辑 /etc/gitlab/gitlab.rb 文件,修改成:
```

```
external_url "https://www.abc.com"
nginx['redirect_http_to_https']=true
nginx['ssl_certificate']="/etc/gitlab/ssl/luck.crt"
nginx['ssl_certificate_key']="/etc/gitlab/ssl/luck.key"
```
之后使用gitlab-ctlreconfigure重建配置,再修改Nginx配置文件/var/opt/gitlab/nginx/conf/gitlab-http.conf里的默认设置:

listen *:443 default_server;
ssl on;
ssl_certificate /etc/gitlab/ssl/ca.crt;
ssl_certificate_key /etc/gitlab/ssl/ca.key;
 

接着再创建一个 /var/opt/gitlab/nginx/conf/index.conf文件用来HTTP跳转HTTPS:

server{
listen *:80;
server_name www.abc.com;

rewrite ^(.*)$ https://$host$1;
}
最后修改/var/opt/gitlab/nginx/conf/nginx.conf配置文件,在其中加入以下内容,来载入index.conf:

include/var/opt/gitlab/nginx/conf/index.conf;
include/var/opt/gitlab/nginx/conf/gitlab-http.conf;